#!/bin/sh

set -e

error_handler() {
  echo "\n\033[0;31mâœ— Commit aborted: One or more checks failed.\033[0m"
  echo "Check the output above for details. Fix the issues, then try committing again."
}
trap error_handler ERR

# Run linting, formatting, type checking, and unit tests
echo "Running Biome lint/format..."
npx biome check --config-path config/biome.jsonc --write --staged --no-errors-on-unmatched --files-ignore-unknown=true

echo "Running TypeScript type check..."
npm run check:typescript

echo "Running Astro check..."
npm run check:astro

echo "Running unit tests..."
npm run test:unit


exit 0
